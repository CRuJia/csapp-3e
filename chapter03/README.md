# 第三章：程序的机器级表示

本章主要是学习汇编语言，了解如何将C程序编译成这种形式的机器代码。
## 知识点：
- 汇编代码与特定机器密切相关的。
- 操作数寻址方式：立即数寻址，寄存器寻址，绝对寻址，间接寻址，比例变址寻址等
- 数据传送：mov（movb,movw,movl,movq分别对应传输字节，字，双字，和四字）。movz是0扩展，movs是符号扩展。
- movl指令以寄存器作为目的时，它会把改寄存器的高位4字节设置为0.
- x86-64的内存引用总是以4字长寄存器（例如%rax）给出。
- lea：加载有效地址（load effecive address）
- 一元操作，只有一个操作数，即是源，又是目的。 inc, dec, neg, not
- 二元操作，第二个操作数即是源，又是目的。add, sub, imul, xor, or, and
- 移位操作：sal, shl, sar, shr 分别对应（算数左移，逻辑左移，算数右移，逻辑右移）

#### 条件码
- CF：进位标志。
- ZF：零标志。
- SF：符号标志。
- OF：溢出标志。

- cmp 比较指令
- test 测试指令
- set 指令，将一个字节设置为0或者1
- jmp 跳转指令

- 条件控制实现条件分支：goto
- 条件传送实现条件分支：cmov




## 脚本

```bash
# -Og 告诉编译器实用会生成符合原始C代码整体结构的机器代码的优化等级
gcc -Og -o p p1.c p2.c

# 只编译
gcc -Og -S mstore.c

# 编译并汇编该代码
gcc -Og -c mstore.c

# 反汇编，查看机器代码文件的内容
mbjdump -d mstore.o
```